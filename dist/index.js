parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"qPoH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TZClient=void 0;var e=n(require("bs58check")),t=n(require("libsodium-wrappers")),r=n(require("bip39")),i=n(require("https")),a=require("url"),s=n(require("crypto"));function n(e){return e&&e.__esModule?e:{default:e}}const c=(e,t)=>new Buffer(Array.from(e).concat(Array.from(t))),o=(e,t,r)=>new Promise((s,n)=>{const c=new a.URL(e);let o="";const h=i.default.request({method:r,origin:c.origin,host:c.host,path:c.pathname},e=>{e.on("data",e=>{o+=e+""}),e.on("end",()=>{try{s(JSON.parse(o.trim()))}catch(e){n(o)}})});h.on("error",n),"POST"===r&&(h.setHeader("Content-Type","application/json"),h.write(JSON.stringify(t))),h.end()}),h=e=>{const t={"00":"parameter","01":"storage","02":"code","03":"False","04":"Elt","05":"Left","06":"None","07":"Pair","08":"Right","09":"Some","0A":"True","0B":"Unit","0C":"PACK","0D":"UNPACK","0E":"BLAKE2B","0F":"SHA256",10:"SHA512",11:"ABS",12:"ADD",13:"AMOUNT",14:"AND",15:"BALANCE",16:"CAR",17:"CDR",18:"CHECK_SIGNATURE",19:"COMPARE","1A":"CONCAT","1B":"CONS","1C":"CREATE_ACCOUNT","1D":"CREATE_CONTRACT","1E":"IMPLICIT_ACCOUNT","1F":"DIP",20:"DROP",21:"DUP",22:"EDIV",23:"EMPTY_MAP",24:"EMPTY_SET",25:"EQ",26:"EXEC",27:"FAILWITH",28:"GE",29:"GET","2A":"GT","2B":"HASH_KEY","2C":"IF","2D":"IF_CONS","2E":"IF_LEFT","2F":"IF_NONE",30:"INT",31:"LAMBDA",32:"LE",33:"LEFT",34:"LOOP",35:"LSL",36:"LSR",37:"LT",38:"MAP",39:"MEM","3A":"MUL","3B":"NEG","3C":"NEQ","3D":"NIL","3E":"NONE","3F":"NOT",40:"NOW",41:"OR",42:"PAIR",43:"PUSH",44:"RIGHT",45:"SIZE",46:"SOME",47:"SOURCE",48:"SENDER",49:"SELF","4A":"STEPS_TO_QUOTA","4B":"SUB","4C":"SWAP","4D":"TRANSFER_TOKENS","4E":"SET_DELEGATE","4F":"UNIT",50:"UPDATE",51:"XOR",52:"ITER",53:"LOOP_LEFT",54:"ADDRESS",55:"CONTRACT",56:"ISNAT",57:"CAST",58:"RENAME",59:"bool","5A":"contract","5B":"int","5C":"key","5D":"key_hash","5E":"lambda","5F":"list",60:"map",61:"big_map",62:"nat",63:"option",64:"or",65:"pair",66:"set",67:"signature",68:"string",69:"bytes","6A":"mutez","6B":"timestamp","6C":"unit","6D":"operation","6E":"address","6F":"SLICE"},r={"00":"int","01":"string","02":"seq","03":["prim",0],"04":["prim",0,!0],"05":["prim",1],"06":["prim",1,!0],"07":["prim",2],"08":["prim",2,!0],"09":["prim",3,!0],"0A":"bytes"};e=e.toUpperCase();let i=0;const a=t=>e.slice(i,i+t),s=()=>{const e=a(2);if(r[e]instanceof Array){i+=2;const n=t[a(2)];return i+=2,{prim:n,args:Array.apply(null,new Array(r[e][1])).map(e=>s())}}if("0A"===e){i+=2;const e=a(8);i+=8;const t=2*parseInt(e,16),r=a(t);return i+=t,{bytes:r}}if("01"===e){i+=2;const e=a(8);i+=8;const t=2*parseInt(e,16),r=a(t);i+=t;const s=new Uint8Array(r.match(/[\dA-F]{2}/g).map(e=>parseInt(e,16)));return{string:new TextDecoder("utf-8").decode(s)}}if("00"===e){i+=2;const e=parseInt(a(2),16).toString(2).padStart(8,"0");i+=2;e[1];const t=[e.slice(2)];let r="1"===e[0];for(;r;){const e=parseInt(a(2),16).toString(2).padStart(8,"0");i+=2,t.push(e.slice(1)),r="1"===e[0]}return{int:parseInt(t.reverse().join(""),2).toString()}}if("02"===e){i+=2;const e=a(8);i+=8;const t=2*parseInt(e,16),r=(a(t),i+t),n=[];for(;r>i;)n.push(s());return n}};return s()},p={contract:new Uint8Array([2,90,121]),identity:new Uint8Array([6,161,159]),public_key:new Uint8Array([13,15,37,217]),secret_key:new Uint8Array([43,246,78,7]),edesk:new Uint8Array([7,90,60,179,41]),signature:new Uint8Array([9,245,205,134,18]),operation:new Uint8Array([5,116])},l={operation:new Uint8Array([3])};class d{constructor(e={}){this.ready=t.default.ready,this.fail_check=Promise.resolve(),this.host=e.host||"https://testnet.tezbridge.com",this.chain_id="main",this.importKey(e)}static enc58(t,r){return e.default.encode(c(t,r))}static dec58(t,r){return e.default.decode(r).slice(t.length)}static r2tz(e){return""+Math.round(1e6*e)}static tz2r(e){return e/1e6+""}static getKeysFromSeed(e){const r=e instanceof Uint8Array?e:d.dec58(p.secret_key,e),i=t.default.crypto_sign_seed_keypair(r);return{public_key:d.enc58(p.public_key,i.publicKey),secret_key:d.enc58(p.secret_key,i.privateKey),public_key_hash:d.enc58(p.identity,t.default.crypto_generichash(20,i.publicKey))}}static genMnemonic(){return r.default.generateMnemonic()}static getSeedFromMnemonic(e,t){return d.enc58(p.secret_key,r.default.mnemonicToSeed(e,t).slice(0,32))}importKey(e){if(this.key_pair={},e.encrypted_seed){const r=d.dec58(p.edesk,e.encrypted_seed),i=r.slice(0,8),a=r.slice(8);return new Promise((r,n)=>{s.default.pbkdf2(e.password,i,32768,32,"sha512",(e,i)=>{e&&n(e);try{const s=t.default.crypto_secretbox_open_easy(a,new Buffer(24),i);this.key_pair=d.getKeysFromSeed(s),r()}catch(e){n(e)}})})}if(e.seed&&(this.key_pair=d.getKeysFromSeed(e.seed)),e.mnemonic&&e.password&&(this.key_pair=d.getKeysFromSeed(d.getSeedFromMnemonic(e.mnemonic,e.password))),e.secret_key){const r=d.dec58(p.secret_key,e.secret_key).slice(32);this.key_pair={secret_key:e.secret_key,public_key:d.enc58(p.public_key,r),public_key_hash:d.enc58(p.identity,t.default.crypto_generichash(20,r))}}return Promise.resolve()}call(e,t={}){return o(this.host+e,t,"GET")}post(e,t={}){return o(this.host+e,t,"POST")}header(){return this.call(`/chains/${this.chain_id}/blocks/head/header`)}head_custom(e){return this.call(`/chains/${this.chain_id}/blocks/head${e}`)}protocol(){return this.header().then(e=>e.protocol)}predecessor(){return this.header().then(e=>e.predecessor)}head_hash(){return this.call(`/chains/${this.chain_id}/blocks/head/hash`)}head(){return this.call(`/chains/${this.chain_id}/blocks/head`)}get_hash_key(e,r){const i=d.dec58(e,r),a=t.default.to_hex(i);return[[0,2],[2,4],[4,6],[6,8],[8,10],[10,void 0]].map(e=>a.slice(e[0],e[1])).join("/")}big_map_with_key(e,t){const r=this.get_hash_key(p.contract,t);return this.call(`/chains/${this.chain_id}/blocks/head/context/raw/bytes/contracts/index/originated/${r}/big_map/${e}`).then(e=>this.decode_bytes(e.data))}raw_storage(e){const t=this.get_hash_key(p.contract,e);return this.call(`/chains/${this.chain_id}/blocks/head/context/raw/bytes/contracts/index/originated/${t}/data/storage`).then(e=>{const r=parseInt(e.slice(0,8),16),i=e.slice(8,8+2*r);return new Promise((e,r)=>{this.call(`/chains/${this.chain_id}/blocks/head/context/raw/bytes/contracts/index/originated/${t}/big_map`).then(t=>{const r={},a=(e,t)=>{for(const i in e)e.data?r[t]=this.decode_bytes(e.data):a(e[i],t+i)};a(t,""),e({storage:this.decode_bytes(i),big_map:r})}).catch(t=>{e({storage:this.decode_bytes(i),big_map:{}})})})})}decode_bytes(e){return h(e)}pack_data(e,t){const r={data:e,type:t,gas:"400000"};return this.post(`/chains/${this.chain_id}/blocks/head/helpers/scripts/pack_data`,r).then(e=>e.packed)}hash_data(e){return Promise.resolve(t.default.to_hex(t.default.crypto_generichash(32,t.default.from_hex(e))))}balance(e){return this.call(`/chains/${this.chain_id}/blocks/head/context/delegates/${e||this.key_pair.public_key_hash}/balance`)}counter(e){return this.call(`/chains/${this.chain_id}/blocks/head/context/contracts/${e||this.key_pair.public_key_hash}/counter`)}counter1(e){return this.counter(e).then(e=>parseInt(e)+1+"")}contract(e){return this.call(`/chains/${this.chain_id}/blocks/head/context/contracts/${e}`)}manager_key(e){return this.call(`/chains/${this.chain_id}/blocks/head/context/contracts/${e||this.key_pair.public_key_hash}/manager_key`)}createOpJSON(e){const t={reveal:{kind:"reveal",source:this.key_pair.public_key_hash,fee:"0",gas_limit:"0",storage_limit:"0",public_key:this.key_pair.public_key},transaction:{kind:"transaction",source:this.key_pair.public_key_hash,fee:"0",gas_limit:"400000",storage_limit:"60000",amount:"0"},origination:{kind:"origination",source:this.key_pair.public_key_hash,fee:"0",gas_limit:"400000",storage_limit:"60000",manager_pubkey:this.key_pair.public_key_hash,balance:"0"}}[e];for(let r=1;r<arguments.length;r++)Object.assign(t,JSON.parse(JSON.stringify(arguments[r])));return t}makeOpWithReveal(e,t,r){return this.counter1(e).then(i=>this.manager_key(e).then(a=>{const s=[];return a.key||s.push(this.createOpJSON("reveal",{counter:i+++"",source:e})),t.forEach(e=>{s.push(this.createOpJSON(e.kind,e.params,{counter:i+++""}))}),this.makeOperations(s,r)}))}originate(e){const t=e.no_injection;return delete e.no_injection,this.makeOpWithReveal(e.source,[{kind:"origination",params:e}],t)}transfer(e){if(!e.destination)return Promise.reject("lack of destination when calling transfer");const t=e.no_injection;return delete e.no_injection,this.makeOpWithReveal(e.source,[{kind:"transaction",params:e}],t)}activate(e){return this.makeOperations([{kind:"activate_account",secret:e,pkh:this.key_pair.public_key_hash}])}makeOperations(e,r){return e=e.map(e=>(["fee","balance","amount"].forEach(t=>{"number"==typeof e[t]&&(e[t]=d.r2tz(e[t]))}),["gas_limit","storage_limit"].forEach(t=>{"number"==typeof e[t]&&(e[t]=e[t]+"")}),e)),this.head_hash().then(r=>{const i={branch:r,contents:e};return Promise.all([i,this.protocol(),this.post(`/chains/${this.chain_id}/blocks/head/helpers/forge/operations`,Object.assign(i))]).then(([e,r,i])=>{const a=t.default.crypto_sign_detached(t.default.crypto_generichash(32,c(l.operation,t.default.from_hex(i))),d.dec58(p.secret_key,this.key_pair.secret_key)),s=i+t.default.to_hex(a);return e.protocol=r,e.signature=d.enc58(p.signature,a),Promise.all([this.post(`/chains/${this.chain_id}/blocks/head/helpers/preapply/operations`,[e]),s])})}).then(([e,t])=>{const i=[].concat.apply([],e.map(e=>e.contents.map(e=>e.metadata.operation_result))).filter(e=>e);if(i.filter(e=>"applied"!==e.status).length)return Promise.reject(e);const a=i.map(e=>e.originated_contracts||[]);return Promise.all([a,r?null:this.post("/injection/operation",t)])}).then(([e,t])=>({contracts:e,operation_id:t}))}}exports.TZClient=d,d.libs={bs58check:e.default,sodium:t.default,bip39:r.default};
},{}],"Focm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.getApiClient=void 0;var e=require("./tzclient.js"),t=o(require("tezexchange-api")),s=o(require("readline")),r=o(require("stream"));function o(e){return e&&e.__esModule?e:{default:e}}const i=(e,t)=>new Promise((r,o)=>{const i=s.default.createInterface({input:process.stdin,output:process.stdout});console.log(e),i.question("",e=>{i.close(),r(e)}),t&&(i._writeToOutput=function(e){i.output.write("")})}),n=async({version:s,secret_key:r,encrypted_seed:o,host:n})=>{const a=new e.TZClient({host:n});if(await a.ready,r)await a.importKey({secret_key:r});else if(o){const e=await i("Password:",!0);await a.importKey({encrypted_seed:o,password:e})}else{const e=await i("Using unencrypted key(1) or encrypted seed(2):");if(1==e){const e=await i("Unencrypted key(edsk):",!0);await a.importKey({secret_key:e})}else if(2==e){const e=await i("Encrypted Seed(edesk):",!0),t=await i("Password:",!0);await a.importKey({encrypted_seed:e,password:t})}}return console.log("=== KEY IMPORTED ==="),console.log(`=== HOST: ${a.host} ===`),new t.default(a,null,s)};exports.getApiClient=n;var a={getApiClient:n};exports.default=a;
},{"./tzclient.js":"qPoH"}]},{},["Focm"], null)
//# sourceMappingURL=/index.map