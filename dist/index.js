parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"qPoH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TZClient=void 0;var e=l(require("babel-runtime/core-js/object/assign")),t=l(require("babel-runtime/core-js/json/stringify")),r=l(require("babel-runtime/core-js/promise")),i=l(require("babel-runtime/core-js/array/from")),a=l(require("bs58check")),s=l(require("libsodium-wrappers")),n=l(require("bip39")),c=l(require("https")),o=require("url"),h=l(require("crypto"));function l(e){return e&&e.__esModule?e:{default:e}}const _=(e,t)=>new Buffer((0,i.default)(e).concat(_Array$from(t))),d=(e,i,a)=>new r.default((r,s)=>{const n=new o.URL(e);let h="";const l=c.default.request({method:a,origin:n.origin,host:n.host,path:n.pathname},e=>{e.on("data",e=>{h+=e+""}),e.on("end",()=>{try{r(JSON.parse(h.trim()))}catch(e){s(h)}})});l.on("error",s),"POST"===a&&(l.setHeader("Content-Type","application/json"),l.write((0,t.default)(i))),l.end()}),p=e=>{const t={"00":"parameter","01":"storage","02":"code","03":"False","04":"Elt","05":"Left","06":"None","07":"Pair","08":"Right","09":"Some","0A":"True","0B":"Unit","0C":"PACK","0D":"UNPACK","0E":"BLAKE2B","0F":"SHA256",10:"SHA512",11:"ABS",12:"ADD",13:"AMOUNT",14:"AND",15:"BALANCE",16:"CAR",17:"CDR",18:"CHECK_SIGNATURE",19:"COMPARE","1A":"CONCAT","1B":"CONS","1C":"CREATE_ACCOUNT","1D":"CREATE_CONTRACT","1E":"IMPLICIT_ACCOUNT","1F":"DIP",20:"DROP",21:"DUP",22:"EDIV",23:"EMPTY_MAP",24:"EMPTY_SET",25:"EQ",26:"EXEC",27:"FAILWITH",28:"GE",29:"GET","2A":"GT","2B":"HASH_KEY","2C":"IF","2D":"IF_CONS","2E":"IF_LEFT","2F":"IF_NONE",30:"INT",31:"LAMBDA",32:"LE",33:"LEFT",34:"LOOP",35:"LSL",36:"LSR",37:"LT",38:"MAP",39:"MEM","3A":"MUL","3B":"NEG","3C":"NEQ","3D":"NIL","3E":"NONE","3F":"NOT",40:"NOW",41:"OR",42:"PAIR",43:"PUSH",44:"RIGHT",45:"SIZE",46:"SOME",47:"SOURCE",48:"SENDER",49:"SELF","4A":"STEPS_TO_QUOTA","4B":"SUB","4C":"SWAP","4D":"TRANSFER_TOKENS","4E":"SET_DELEGATE","4F":"UNIT",50:"UPDATE",51:"XOR",52:"ITER",53:"LOOP_LEFT",54:"ADDRESS",55:"CONTRACT",56:"ISNAT",57:"CAST",58:"RENAME",59:"bool","5A":"contract","5B":"int","5C":"key","5D":"key_hash","5E":"lambda","5F":"list",60:"map",61:"big_map",62:"nat",63:"option",64:"or",65:"pair",66:"set",67:"signature",68:"string",69:"bytes","6A":"mutez","6B":"timestamp","6C":"unit","6D":"operation","6E":"address","6F":"SLICE"},r={"00":"int","01":"string","02":"seq","03":["prim",0],"04":["prim",0,!0],"05":["prim",1],"06":["prim",1,!0],"07":["prim",2],"08":["prim",2,!0],"09":["prim",3,!0],"0A":"bytes"};e=e.toUpperCase();let i=0;const a=t=>e.slice(i,i+t),s=()=>{const e=a(2);if(r[e]instanceof Array){i+=2;const n=t[a(2)];return i+=2,{prim:n,args:Array.apply(null,new Array(r[e][1])).map(e=>s())}}if("0A"===e){i+=2;const e=a(8);i+=8;const t=2*parseInt(e,16),r=a(t);return i+=t,{bytes:r}}if("01"===e){i+=2;const e=a(8);i+=8;const t=2*parseInt(e,16),r=a(t);i+=t;const s=new Uint8Array(r.match(/[\dA-F]{2}/g).map(e=>parseInt(e,16)));return{string:new TextDecoder("utf-8").decode(s)}}if("00"===e){i+=2;const e=parseInt(a(2),16).toString(2).padStart(8,"0");i+=2;e[1];const t=[e.slice(2)];let r="1"===e[0];for(;r;){const e=parseInt(a(2),16).toString(2).padStart(8,"0");i+=2,t.push(e.slice(1)),r="1"===e[0]}return{int:parseInt(t.reverse().join(""),2).toString()}}if("02"===e){i+=2;const e=a(8);i+=8;const t=2*parseInt(e,16),r=(a(t),i+t),n=[];for(;r>i;)n.push(s());return n}};return s()},u={contract:new Uint8Array([2,90,121]),identity:new Uint8Array([6,161,159]),public_key:new Uint8Array([13,15,37,217]),secret_key:new Uint8Array([43,246,78,7]),edesk:new Uint8Array([7,90,60,179,41]),signature:new Uint8Array([9,245,205,134,18]),operation:new Uint8Array([5,116])},y={operation:new Uint8Array([3])};class m{constructor(e={}){this.ready=s.default.ready,this.fail_check=_Promise.resolve(),this.host=e.host||"https://testnet.tezbridge.com",this.chain_id="main",this.importKey(e)}static enc58(e,t){return a.default.encode(_(e,t))}static dec58(e,t){return a.default.decode(t).slice(e.length)}static r2tz(e){return""+Math.round(1e6*e)}static tz2r(e){return e/1e6+""}static getKeysFromSeed(e){const t=e instanceof Uint8Array?e:m.dec58(u.secret_key,e),r=s.default.crypto_sign_seed_keypair(t);return{public_key:m.enc58(u.public_key,r.publicKey),secret_key:m.enc58(u.secret_key,r.privateKey),public_key_hash:m.enc58(u.identity,s.default.crypto_generichash(20,r.publicKey))}}static genMnemonic(){return n.default.generateMnemonic()}static getSeedFromMnemonic(e,t){return m.enc58(u.secret_key,n.default.mnemonicToSeed(e,t).slice(0,32))}importKey(e){if(this.key_pair={},e.encrypted_seed){const t=m.dec58(u.edesk,e.encrypted_seed),r=t.slice(0,8),i=t.slice(8);return new _Promise((t,a)=>{h.default.pbkdf2(e.password,r,32768,32,"sha512",(e,r)=>{e&&a(e);try{const n=s.default.crypto_secretbox_open_easy(i,new Buffer(24),r);this.key_pair=m.getKeysFromSeed(n),t()}catch(e){a(e)}})})}if(e.seed&&(this.key_pair=m.getKeysFromSeed(e.seed)),e.mnemonic&&e.password&&(this.key_pair=m.getKeysFromSeed(m.getSeedFromMnemonic(e.mnemonic,e.password))),e.secret_key){const t=m.dec58(u.secret_key,e.secret_key).slice(32);this.key_pair={secret_key:e.secret_key,public_key:m.enc58(u.public_key,t),public_key_hash:m.enc58(u.identity,s.default.crypto_generichash(20,t))}}return _Promise.resolve()}call(e,t={}){return d(this.host+e,t,"GET")}post(e,t={}){return d(this.host+e,t,"POST")}header(){return this.call(`/chains/${this.chain_id}/blocks/head/header`)}head_custom(e){return this.call(`/chains/${this.chain_id}/blocks/head${e}`)}protocol(){return this.header().then(e=>e.protocol)}predecessor(){return this.header().then(e=>e.predecessor)}head_hash(){return this.call(`/chains/${this.chain_id}/blocks/head/hash`)}head(){return this.call(`/chains/${this.chain_id}/blocks/head`)}get_hash_key(e,t){const r=m.dec58(e,t),i=s.default.to_hex(r);return[[0,2],[2,4],[4,6],[6,8],[8,10],[10,void 0]].map(e=>i.slice(e[0],e[1])).join("/")}big_map_with_key(e,t){const r=this.get_hash_key(u.contract,t);return this.call(`/chains/${this.chain_id}/blocks/head/context/raw/bytes/contracts/index/originated/${r}/big_map/${e}`).then(e=>this.decode_bytes(e.data))}raw_storage(e){const t=this.get_hash_key(u.contract,e);return this.call(`/chains/${this.chain_id}/blocks/head/context/raw/bytes/contracts/index/originated/${t}/data/storage`).then(e=>{const r=parseInt(e.slice(0,8),16),i=e.slice(8,8+2*r);return new _Promise((e,r)=>{this.call(`/chains/${this.chain_id}/blocks/head/context/raw/bytes/contracts/index/originated/${t}/big_map`).then(t=>{const r={},a=(e,t)=>{for(const i in e)e.data?r[t]=this.decode_bytes(e.data):a(e[i],t+i)};a(t,""),e({storage:this.decode_bytes(i),big_map:r})}).catch(t=>{e({storage:this.decode_bytes(i),big_map:{}})})})})}decode_bytes(e){return p(e)}pack_data(e,t){const r={data:e,type:t,gas:"400000"};return this.post(`/chains/${this.chain_id}/blocks/head/helpers/scripts/pack_data`,r).then(e=>e.packed)}hash_data(e){return _Promise.resolve(s.default.to_hex(s.default.crypto_generichash(32,s.default.from_hex(e))))}balance(e){return this.call(`/chains/${this.chain_id}/blocks/head/context/delegates/${e||this.key_pair.public_key_hash}/balance`)}counter(e){return this.call(`/chains/${this.chain_id}/blocks/head/context/contracts/${e||this.key_pair.public_key_hash}/counter`)}counter1(e){return this.counter(e).then(e=>parseInt(e)+1+"")}contract(e){return this.call(`/chains/${this.chain_id}/blocks/head/context/contracts/${e}`)}manager_key(e){return this.call(`/chains/${this.chain_id}/blocks/head/context/contracts/${e||this.key_pair.public_key_hash}/manager_key`)}createOpJSON(t){const r={reveal:{kind:"reveal",source:this.key_pair.public_key_hash,fee:"0",gas_limit:"0",storage_limit:"0",public_key:this.key_pair.public_key},transaction:{kind:"transaction",source:this.key_pair.public_key_hash,fee:"0",gas_limit:"400000",storage_limit:"60000",amount:"0"},origination:{kind:"origination",source:this.key_pair.public_key_hash,fee:"0",gas_limit:"400000",storage_limit:"60000",manager_pubkey:this.key_pair.public_key_hash,balance:"0"}}[t];for(let i=1;i<arguments.length;i++)(0,e.default)(r,JSON.parse(_JSON$stringify(arguments[i])));return r}makeOpWithReveal(e,t,r){return this.counter1(e).then(i=>this.manager_key(e).then(a=>{const s=[];return a.key||s.push(this.createOpJSON("reveal",{counter:i+++"",source:e})),t.forEach(e=>{s.push(this.createOpJSON(e.kind,e.params,{counter:i+++""}))}),this.makeOperations(s,r)}))}originate(e){const t=e.no_injection;return delete e.no_injection,this.makeOpWithReveal(e.source,[{kind:"origination",params:e}],t)}transfer(e){if(!e.destination)return _Promise.reject("lack of destination when calling transfer");const t=e.no_injection;return delete e.no_injection,this.makeOpWithReveal(e.source,[{kind:"transaction",params:e}],t)}activate(e){return this.makeOperations([{kind:"activate_account",secret:e,pkh:this.key_pair.public_key_hash}])}makeOperations(e,t){return e=e.map(e=>(["fee","balance","amount"].forEach(t=>{"number"==typeof e[t]&&(e[t]=m.r2tz(e[t]))}),["gas_limit","storage_limit"].forEach(t=>{"number"==typeof e[t]&&(e[t]=e[t]+"")}),e)),this.head_hash().then(t=>{const r={branch:t,contents:e};return _Promise.all([r,this.protocol(),this.post(`/chains/${this.chain_id}/blocks/head/helpers/forge/operations`,_Object$assign(r))]).then(([e,t,r])=>{const i=s.default.crypto_sign_detached(s.default.crypto_generichash(32,_(y.operation,s.default.from_hex(r))),m.dec58(u.secret_key,this.key_pair.secret_key)),a=r+s.default.to_hex(i);return e.protocol=t,e.signature=m.enc58(u.signature,i),_Promise.all([this.post(`/chains/${this.chain_id}/blocks/head/helpers/preapply/operations`,[e]),a])})}).then(([e,r])=>{const i=[].concat.apply([],e.map(e=>e.contents.map(e=>e.metadata.operation_result))).filter(e=>e);if(i.filter(e=>"applied"!==e.status).length)return _Promise.reject(e);const a=i.map(e=>e.originated_contracts||[]);return _Promise.all([a,t?null:this.post("/injection/operation",r)])}).then(([e,t])=>({contracts:e,operation_id:t}))}}exports.TZClient=m,m.libs={bs58check:a.default,sodium:s.default,bip39:n.default};
},{}],"Focm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.getApiClient=void 0;var e=i(require("babel-runtime/helpers/asyncToGenerator")),t=i(require("babel-runtime/core-js/promise")),r=require("./tzclient.js"),s=i(require("tezexchange-api")),o=i(require("readline")),n=i(require("stream"));function i(e){return e&&e.__esModule?e:{default:e}}const d=(e,r)=>new t.default((t,s)=>{const n=o.default.createInterface({input:process.stdin,output:process.stdout});console.log(e),n.question("",e=>{n.close(),t(e)}),r&&(n._writeToOutput=function(e){n.output.write("")})}),l=(()=>{var t=(0,e.default)(function*({version:e,secret_key:t,encrypted_seed:o,host:n}){const i=new r.TZClient({host:n});if(yield i.ready,t)yield i.importKey({secret_key:t});else if(o){const e=yield d("Password:",!0);yield i.importKey({encrypted_seed:o,password:e})}else{const e=yield d("Using unencrypted key(1) or encrypted seed(2):");if(1==e){const e=yield d("Unencrypted key(edsk):",!0);yield i.importKey({secret_key:e})}else if(2==e){const e=yield d("Encrypted Seed(edesk):",!0),t=yield d("Password:",!0);yield i.importKey({encrypted_seed:e,password:t})}}return console.log("=== KEY IMPORTED ==="),console.log(`=== HOST: ${i.host} ===`),new s.default(i,null,e)});return function(e){return t.apply(this,arguments)}})();exports.getApiClient=l;var u={getApiClient:l};exports.default=u;
},{"./tzclient.js":"qPoH"}]},{},["Focm"], null)
//# sourceMappingURL=/index.map